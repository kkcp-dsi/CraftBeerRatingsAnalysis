[["index.html", "Craft Beer Ratings Analysis Chapter 1 Introduction", " Craft Beer Ratings Analysis Krishna Kalluri, Chao Pang 2021-12-11 Chapter 1 Introduction Beer is a everyday drink that we are all familiar with, the classic impression of a beer such as Heineken and Budweiser is that it has a light body, a refreshing and slightly bitter taste. I believe all of us share a similar experience where we tried a sip of beer for the first time and only got disappointed by it. Every since that trauma, the question would automatically pop up whenever we see other people consume beer with delight, why would people love it? Beer is normally portrayed as a cheap, easy to access, and down to the earth type of beverage, it never received the attention that wine has been enjoying in the past decades. Both of us felt the same way when we first started drinking beer, it’s more of a way to get you into the party mood and sometimes we would drink for effect rather than the taste. That changed about 5 years ago when we first got exposed to craft beer and we fell in love with it immediately, our beer journey started since then. Before we dive into the investigation of the craft beer, let’s us get the definition of craft beer out of the way first. A craft beer is defined as a beer made by a brewer that is small, independent, and traditional. According to the Brewers Association (BA), an industry group of mostly small, independent brewers, there are more than 8,000 craft breweries in the U.S. Nearly 4,000 of them opened between 2015–2020. With steady growth in in craft beer community, craft brewers started organizing beer festivals and making craft beers available at multiple locations, that’s when people got to try different styles of beers and this changed our perception altogether. Until a few years ago, a few online websites and phone apps were developed for people to share the experience and knowledge about craft beers. Specifically, there are a few well-known beer websites that motivate for social drinking such as Untappd and BeerAdvocate (similar to IMDB), where people could find the information on beers, give their own ratings to the beers and also leave comments, and this actually generated a lot of valuable data. For example, the beer apps could leverage this data for developing beer recommendation systems and predict what is going to be the next popular beer? Despite the data is being collected by those organizations and companies, this data is still publicly available on their websites or through their own API end point. As we both are craft beer enthusiasts and on a mission of drinking the best craft beers in the US. Due to the sheer large number of breweries and beers available nowadays, it would be impossible to try every one of them, therefore we would have to apply some data driven approach to help us identify good beers more efficiently. Although “what is a good beer” is a highly subjective question, there is some census among the beer geeks in terms of what beer styles are preferred and what beers tend to get higher ratings. We have been wanting to conduct some beer analyses to understand the landscape of the craft beer industry. Doing so will allow us better understand our own tastes, and enable us to apply a data driven approach for beer hunting. And this final project gives us an opportunity to do just that. In this project, we are going to apply the EDAV techniques to the beer rating data (will be discussed later in data source) in conjunction with our beer knowledge, hopefully we will gain some new insights that we didn’t previously know. Specifically, we decided to analyze the beer styles, beer characteristics, regional origins, and the corresponding ratings given out by users, we have designed a few starter questions to get us started shown below, however, as we dive into the data deeper, the questions will definitely go beyond the scope defined here in the later chapters. To formulate the starter questions, Where are the breweries located across the US? Which of the states have the most breweries? Is there any correlation between the region of the brewery and the user rating? Do different states tend to brew certain beer styles? Is there a correlation between beer styles and user ratings? Do certain beer styles tend to be rated higher than other styles? What traits of the beers tend to receive higher ratings? "],["data-sources.html", "Chapter 2 Data sources 2.1 OpenBreweryDB  2.2 Untappd", " Chapter 2 Data sources To answer these questions, we’ve obtained data from two sources OpenBreweryDB and Untappd, which we will describe in detail in the following sections. We are still working on obtaining the ingredients of beers, depending on whether or not we will actually acquire the data, our questions may be subject to changes.  2.1 OpenBreweryDB  Open Brewery DB is a free dataset and API with public information on breweries, cideres, brewpubs, and bottle shops. We downloaded lists of breweries per state using the OpenBreweryDB API. List Breweries API We used the brewery names downloaded from OpenBreweryDB as queries to get the list of beers and their corresponding aggregated rating information from the Untappd. 2.2 Untappd Untappd is a social network for beer enthusiasts that allows its users to check-in as they drink beers, share these check-ins, and option to rate the beer they are consuming, earn badges, share pictures of their beers, comment on checked-in beers. It also allows Breweries to officially post the beers that they produce. (paraphrased the definition from Wikipedia). "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Web Scrapper 3.2 Merge Beer ratings data 3.3 Merge Brewery Info data 3.4 Data Cleaning", " Chapter 3 Data transformation 3.1 Web Scrapper We built a parser to get the list of beers from untappd using Python as we started scrapping data earlier than when we were introduced to web scrapping in R. The web scraper uses beautiful soup a library in python to scrape the data from web pages. The process workflow in the web scrapper: We used the downloaded a csv file from List Breweries APIthen filter the breweries list from the csv for the state we are trying to download the data for. Then the scraper opens untappd search bar to find each breweries page on untappd and opens a brewery page once the brewery page is opened it goes to page source and searches for div class beer-list and distinct-list once it finds the div class it expands the div class looks for another div class beer-item and gets beer_url, beer_name, beer_style, beer_desc, beer_abv, beer_ibu, beer_average_rating, beer_num_ratings, beer_added and adds everything to a csv. For the Brewery data we run a similar scrapper to get brewery_id, average_rating, num_of_ratings, num_of_beers, total_check_ins, unique_user_check_ins, last_four_week_check_ins, brewery_desc and adds everything to a csv. Using this web scrapper we scraped the rating information for the top 24 most popular beers for each brewery on untappd for all the states in US. Because the brewery name downloaded from OpenBreweryDB is not the same as the one used in untappd, we used the untappd search function to resolve the brewery name first, then retrieved the top 24 most popular beers associated with that brewery. To use the web scrapper and download the data try following the below steps: $ cd brewery_beer_parser $ pip install -r requirements.txt $ python3 beer_scraping.py -i data/breweries.csv -o brewery_beers/ -s &quot;New York&quot; Once the scrapping is done the data for New York outputs as following All the beers per brewery will be exported to -&gt; brewery_beer_parser/brewery_beers/New_York/*brewery_name.csv All the breweries that the parser could find the beers for will be exported to -&gt; brewery_beer_parser/brewery_beers/New_York_brewery_info.csv Once we repeated this step for all the states we manually copied the state_brewery_info.csv to brewery_beer_parser/Breweries/ we used following python code to merge all the beer data and brewery data. 3.2 Merge Beer ratings data path = r&#39;brewery_beers&#39; extension = &#39;.csv&#39; csv_list = [] for root, dirs, files in os.walk(path): for filename in files: if os.path.splitext(filename)[-1] == extension: csv_list.append(os.path.join(root, filename)) frames = [] for file in csv_list: state_and_brewery = file.split(&#39;/&#39;) df = pd.read_csv(file, index_col=False) df.insert(1, &#39;brewery&#39;, state_and_brewery[2].split(&#39;.&#39;)[0]) df.insert(2, &#39;state&#39;, state_and_brewery[2]) df[&#39;state&#39;] = state_and_brewery[1] df[&#39;brewery&#39;] = state_and_brewery[2].split(&#39;.&#39;)[0] df.drop(df.columns[df.columns.str.contains(&#39;unnamed&#39;,case = False)],axis = 1, inplace = True) frames.append(df) # exports to csv file pd.concat(frames).to_csv(&#39;all_beers.csv&#39;) We Added State and Brewery name to beer dataset in order to make it easy for us to join brewery data to beer data. 3.3 Merge Brewery Info data breweries_list = [] for root, dirs, files in os.walk(path): for filename in files: if os.path.splitext(filename)[-1] == extension: breweries_list.append(os.path.join(root, filename)) brewery_frames = [] for file in breweries_list: df = pd.read_csv(file, index_col=False) df.drop(df.columns[df.columns.str.contains(&#39;unnamed&#39;,case = False)],axis = 1, inplace = True) brewery_frames.append(df) #exports to csv file pd.concat(brewery_frames).to_csv(&#39;all_breweries.csv&#39;) ** We did check https://untapped.com/robots.txt to see if scrapping is permitted. They do not have any restrictions under user agents. And we also checked their user agreement. There weren’t any rules about getting data for the list of beers. They only mentioned rules about obtaining user data. 3.4 Data Cleaning 3.4.1 Sample Beer Ratings Data: ## # A tibble: 20 × 11 ## brewery state beer_url beer_name beer_style beer_desc beer_abv beer_ibu beer_average_ra… ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 Dry_Coun… North… https://untap… Bone Mus… Stout - Ru… &lt;NA&gt; 11.1% A… N/A IBU 4.12 ## 2 Off_Camb… Washi… https://untap… Imperial… Pumpkin / … &lt;NA&gt; 9% ABV N/A IBU 4.02 ## 3 Chapel_B… Minne… https://untap… DDH Citr… IPA - Brut &lt;NA&gt; 6% ABV N/A IBU NA ## 4 Noble_Ro… Wisco… https://untap… Cherry B… Pale Ale -… Brewed with br… 5.5% ABV 24 IBU 3.46 ## 5 Bluejack… Distr… https://untap… Darling … Pale Ale -… american pale … 6.4% ABV 50 IBU 3.64 ## 6 Beach_Ha… New_J… https://untap… Flannel Red Ale - … A Carrot Cake … 6.3% ABV 26 IBU 3.67 ## 7 Lookingg… Oregon https://untap… T Minus … Pale Ale -… Combination of… 6% ABV 45 IBU 3.42 ## 8 Mia_and_… Oregon https://untap… Emmet &amp; … Pilsner - … &lt;NA&gt; 4.4% ABV N/A IBU 2.93 ## 9 Quaff_On… India… https://untap… McRyan O… Stout - Ir… &lt;NA&gt; 8% ABV 25 IBU 3.56 ## 10 Foggy_No… Washi… https://untap… Cease &amp; … IPA - Engl… Brewed in hono… 6.3% ABV 70 IBU 3.38 ## 11 Riggs_Be… Illin… https://untap… Black IPL IPA - Blac… Roast. Coffee.… 7.3% ABV 65 IBU 3.76 ## 12 Johnnie_… Nebra… https://untap… The Aven… Wheat - A… Clean, easy dr… 5.51% A… 18 IBU 3.38 ## 13 Courthou… Wisco… https://untap… Patio Po… Shandy / R… A raspberry li… 4.8% ABV 12 IBU 3.7 ## 14 Wind_Shi… Misso… https://untap… Dark Mild Mild - Oth… &lt;NA&gt; 4% ABV 18 IBU 4.01 ## 15 Skookum_… Washi… https://untap… Solitary… Stout - Im… Bourbon barrel… 10.5% A… 50 IBU 4.2 ## 16 Bang_Bre… Minne… https://untap… Scratchy… IPA - Blac… &lt;NA&gt; 6% ABV 56 IBU 3.76 ## 17 Ten_Mile… Calif… https://untap… Sunnyside Pilsner - … &lt;NA&gt; 4.8% ABV N/A IBU 3.82 ## 18 BS_Brewi… Texas https://untap… Tiki Tem… Sour - Ber… Tart with the … 4.3% ABV 5 IBU 3.55 ## 19 Stones_T… Washi… https://untap… Mickey&#39;s… Red Ale - … Mickey&#39;s Irish… 6% ABV N/A IBU 3.55 ## 20 Amplifie… Calif… https://untap… Doc März… Märzen Traditional mä… 5.3% ABV N/A IBU 3.68 ## # … with 2 more variables: beer_num_ratings &lt;dbl&gt;, beer_added &lt;chr&gt; 3.4.2 Sample Brewery Info Data: ## # A tibble: 10 × 25 ## obdb_id name brewery_type street address_2 address_3 city state county_province postal_code ## &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt; &lt;lgl&gt; &lt;chr&gt; ## 1 redhook-br… Redhook… regional 714 E P… NA NA Seatt… Washi… NA 98122-4697 ## 2 railhouse-… Railhou… micro 105 E S… NA NA Aberd… North… NA 28315- ## 3 westtown-b… Westtow… micro 236 Sch… NA NA Westt… New Y… NA 10998- ## 4 spencer-br… Spencer… micro 167 N S… NA NA Spenc… Massa… NA 01562-1232 ## 5 hair-of-th… Hair of… brewpub 61 SE Y… NA NA Portl… Oregon NA 97214-2134 ## 6 swiftwater… Swiftwa… brewpub 378 Mou… NA NA Roche… New Y… NA 14620-1250 ## 7 kinney-cre… Kinney … micro 1016 7t… NA NA Roche… Minne… NA 55901-2668 ## 8 saugatuck-… Saugatu… micro 2948 Bl… NA NA Dougl… Michi… NA 49406-5195 ## 9 1817-brewe… 1817 Br… micro 100 B S… NA NA okolo… Missi… NA 38860 ## 10 solorio-br… Solorio… micro 9395 Fe… NA NA Ranch… Calif… NA 91730-4565 ## # … with 15 more variables: website_url &lt;chr&gt;, phone &lt;chr&gt;, country &lt;chr&gt;, longitude &lt;dbl&gt;, ## # latitude &lt;dbl&gt;, tags &lt;lgl&gt;, brewery_id &lt;chr&gt;, average_rating &lt;dbl&gt;, num_of_ratings &lt;dbl&gt;, ## # num_of_beers &lt;dbl&gt;, total_check_ins &lt;chr&gt;, unique_user_check_ins &lt;chr&gt;, ## # last_four_week_check_ins &lt;dbl&gt;, brewery_desc &lt;chr&gt;, brewery &lt;chr&gt; We cleaned up the beer_abv column by removing the characters % ABV and beer_ibu column by removing the characters IBU . Cleaned up date values to same format and added a new column named year. Generalized known similar types of beer styles Cleaned up state name in cleaned_all_beers to remove _ ’s Remove unusable columns in all_breweries data frame and rename name column Cleaned breweries with less than 10 beers total and the breweries which are closed, proprietor, bar as there are mostly useless for our question. "],["missing-values.html", "Chapter 4 Missing values", " Chapter 4 Missing values "],["results.html", "Chapter 5 Results", " Chapter 5 Results "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "]]
