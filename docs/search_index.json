[["index.html", "Craft Beer Ratings Analysis Chapter 1 Introduction", " Craft Beer Ratings Analysis Krishna Kalluri, Chao Pang 2021-12-12 Chapter 1 Introduction Beer is a everyday drink that we are all familiar with, the classic impression of a beer such as Heineken and Budweiser is that it has a light body, a refreshing and slightly bitter taste. I believe all of us share a similar experience where we tried a sip of beer for the first time and only got disappointed by it. Every since that trauma, the question would automatically pop up whenever we see other people consume beer with delight, why would people love it? Beer is normally portrayed as a cheap, easy to access, and down to the earth type of beverage, it never received the attention that wine has been enjoying in the past decades. Both of us felt the same way when we first started drinking beer, it’s more of a way to get you into the party mood and sometimes we would drink for effect rather than the taste. That changed about 5 years ago when we first got exposed to craft beer and we fell in love with it immediately, our beer journey started since then. Before we dive into the investigation of the craft beer, let’s us get the definition of craft beer out of the way first. A craft beer is defined as a beer made by a brewer that is small, independent, and traditional. According to the Brewers Association (BA), an industry group of mostly small, independent brewers, there are more than 8,000 craft breweries in the U.S. Nearly 4,000 of them opened between 2015–2020. With steady growth in in craft beer community, craft brewers started organizing beer festivals and making craft beers available at multiple locations, that’s when people got to try different styles of beers and this changed our perception altogether. Until a few years ago, a few online websites and phone apps were developed for people to share the experience and knowledge about craft beers. Specifically, there are a few well-known beer websites that motivate for social drinking such as Untappd and BeerAdvocate (similar to IMDB), where people could find the information on beers, give their own ratings to the beers and also leave comments, and this actually generated a lot of valuable data. For example, the beer apps could leverage this data for developing beer recommendation systems and predict what is going to be the next popular beer? Despite the data is being collected by those organizations and companies, this data is still publicly available on their websites or through their own API end point. As we both are craft beer enthusiasts and on a mission of drinking the best craft beers in the US. Due to the sheer large number of breweries and beers available nowadays, it would be impossible to try every one of them, therefore we would have to apply some data driven approach to help us identify good beers more efficiently. Although “what is a good beer” is a highly subjective question, there is some census among the beer geeks in terms of what beer styles are preferred and what beers tend to get higher ratings. We have been wanting to conduct some beer analyses to understand the landscape of the craft beer industry. Doing so will allow us better understand our own tastes, and enable us to apply a data driven approach for beer hunting. And this final project gives us an opportunity to do just that. In this project, we are going to apply the EDAV techniques to the beer rating data (will be discussed later in data source) in conjunction with our beer knowledge, hopefully we will gain some new insights that we didn’t previously know. Specifically, we decided to analyze the beer styles, beer characteristics, regional origins, and the corresponding ratings given out by users, we have designed a few starter questions to get us started shown below, however, as we dive into the data deeper, the questions will definitely go beyond the scope defined here in the later chapters. To formulate the starter questions, Where are the breweries located across the US? Which of the states have the most breweries? Is there any correlation between the region of the brewery and the user rating? Do different states tend to brew certain beer styles? Is there a correlation between beer styles and user ratings? Do certain beer styles tend to be rated higher than other styles? What traits of the beers tend to receive higher ratings? "],["data-sources.html", "Chapter 2 Data sources 2.1 OpenBreweryDB  2.2 Untappd 2.3 Web Scrapper", " Chapter 2 Data sources To answer these questions, we’ve obtained data from two sources OpenBreweryDB and Untappd, which we will describe in detail in the following sections. We are still working on obtaining the ingredients of beers, depending on whether or not we will actually acquire the data, our questions may be subject to changes.  2.1 OpenBreweryDB  Open Brewery DB is a free dataset and API with public information on breweries, cideres, brewpubs, and bottle shops. We downloaded lists of breweries per state using the OpenBreweryDB API. List Breweries API We used the brewery names downloaded from OpenBreweryDB as queries to get the list of beers and their corresponding aggregated rating information from the Untappd. 2.2 Untappd Untappd is a social network for beer enthusiasts that allows its users to check-in as they drink beers, share these check-ins, and option to rate the beer they are consuming, earn badges, share pictures of their beers, comment on checked-in beers. It also allows Breweries to officially post the beers that they produce. (paraphrased the definition from Wikipedia). 2.3 Web Scrapper We built a parser to get the list of beers from untappd using Python as we started scrapping data earlier than when we were introduced to web scrapping in R. Our web scraper uses beautiful soup a library in python to scrape the data from web pages. The workflow of the web scrapper is as follows: We used the downloaded a csv file from List Breweries APIthen filter the breweries list from the csv for the state we are trying to download the data for. The brewery name downloaded from OpenBreweryDB in some cases is not the same as the one used in untappd, we used the untappd search function to resolve the brewery name first, the scraper opens untappd search bar to find each breweries page on untappd and opens a brewery page. Once the brewery page is found and opened scrapper goes to page source and searches for div class beer-list and distinct-list once it finds the div class it expands the div class looks for another div class beer-item and gets beer_url, beer_name, beer_style, beer_desc, beer_abv, beer_ibu, beer_average_rating, beer_num_ratings, beer_added and adds everything to a csv. For the Brewery data we run a similar scrapper to get brewery_id, average_rating, num_of_ratings, num_of_beers, total_check_ins, unique_user_check_ins, last_four_week_check_ins, brewery_desc and adds everything to a csv. Using this web scrapper we scraped the rating information for the top 24 most popular beers for each brewery on untappd for all the states in US. then retrieved the top 24 most popular beers associated with that brewery. To use the web scrapper and download the data try following the below steps: $ cd brewery_beer_parser $ pip install -r requirements.txt $ python3 beer_scraping.py -i data/breweries.csv -o brewery_beers/ -s &quot;New York&quot; Once the scrapping is done the data for New York outputs as following All the beers per brewery will be exported to -&gt; brewery_beer_parser/brewery_beers/New_York/*brewery_name.csv All the breweries that the parser could find the beers for will be exported to -&gt; brewery_beer_parser/brewery_beers/New_York_brewery_info.csv Once we repeated this step for all the states we manually copied the state_brewery_info.csv to brewery_beer_parser/Breweries/ ** We did check &lt;https://untapped.com/robots.txt&gt; to see if scrapping is permitted. They do not have any restrictions under user agents. And we also checked their user agreement. There weren’t any rules about getting data for the list of beers. They only mentioned rules about obtaining user data. "],["data-transformation.html", "Chapter 3 Data transformation 3.1 Data Cleaning", " Chapter 3 Data transformation To merge all the beer ratings data downloaded by the web scrapper into single csv file and brewery ratings data downloaded by the web scrapper into single csv, we used a python script data_merger.py located in the repository. To run the data merger and save the merged csv files into data folder follow below steps. $ cd CraftBeerRatingsAnalysis/brewery_beer_parser $ python3 data_merger.py ** We Added State and Brewery name to beer dataset using the in order to make it easy for us to join brewery data to beer data in case if we needed that in our further analysis. Merged data will be exported to data directory in the project. Beer data: CraftBeerRatingsAnalysis/data/all_beers.csv Brewery Data: CraftBeerRatingsAnalysis/data/all_breweries.csv 3.1 Data Cleaning 3.1.1 Beer Ratings Data: Before Cleaning Cleaned up the beer_abv column by removing the characters % ABV and beer_ibu column by removing the characters IBU and converted those columns to a double datatype. Cleaned up date values to same format and added a new column named year. Generalized known duplicated beer styles. Cleaned up state name in cleaned_all_beers to remove _ ’s After Cleaning 3.1.2 Brewery Info Data: Removed un-necessary columns in all_breweries data frame and renamed name to brewery_name column. Cleaned breweries with less than 10 beers total and the breweries which are closed, proprietor, bar as there are mostly useless for our question. After Cleaning "],["missing-values.html", "Chapter 4 Missing values 4.1 Missing Values in Beer Ratings Dataset 4.2 Missing Values in Brewery Ratings Dataset", " Chapter 4 Missing values Too find out the missing values in our cleaned data sets we used a missing_value_plot function we created as part of our course assignment. The missing_value plot function can be found at plot_missing.R 4.1 Missing Values in Beer Ratings Dataset The more percentage of missing values in the cleaned_all_beers dataset are in beer_ibu, beer_desc and beer_abv columns. We can ignore beer_desc column as that column will not help in out analysis. In case of beer_abv and beer_ibu we are going to to remove the null value rows while utilizing these variables in our analysis as we cannot add the data to the missing rows using any of the generalization methods. beer_ibu and beer_abv can tell a lot about a beer taste so we do not want to drop these columns as well. 4.2 Missing Values in Brewery Ratings Dataset The more percentage of missing values in the cleaned_brewery_dataset is in latitude and Longitude columns. We are ignoring these columns as we have other columns we can utilize to get spatial maps namely city and state. "],["results.html", "Chapter 5 Results 5.1 Where are the breweries located? 5.2 What kind of beer styles are most popular across the US? 5.3 Do people rate beers/breweries differently across the US? 5.4 What are the popular beer styles? 5.5 What are the highly rated beer styles and what makes a beer better rated? 5.6 Ratings for West Coast IPA and East Coast IPA", " Chapter 5 Results In the results section, we are going to start with exploring the brewery data. There are a few angles that we can go about this. Firstly, we will explore the distribution of the breweries across the US?; Secondly we will look at what styles of beer are most popular in different states because we think different states tend to brew or specialize in different styles. Last but not the least, we will investigate whether there is a difference in terms of the user rating behaviors across states because we suspect that people from different states might have different rating behaviors. After exploring the brewery data, we will look at the beer data, and the specific traits of the beers we are going after include beer style, beer alcohol by volume (ABU), beer international bitterness units (IBU), and average user ratings, the big question is that why are certain beer styles getting attention and better ratings than others? We will aim to answer this question using a series of plots to understand different aspects of the beer data. 5.1 Where are the breweries located? Let’s first take a look at a sample of the the brewery data below. The dataset contains the brewery name, description, address, geo coordinates, average user ratings of the brewery (calculated by the average rating of all beer ratings), the number of beers, the number of ratings given the brewery received in total, and etc. We used tigris for generating an interactive map to show the number of breweries across the US. When you click on each state, a popup window will appear to show the additional information such as the number of breweries, number of beers made, the average brewery rating for that state. Based on this map, it’s clearly to see that most of the breweries are located in the northeast region, west coast, and Texas and Colorado. In particular, California has the most breweries (547 in total), which surpasses the runner-up Washington state (274 in total). If you want to have a full craft beer experience, I guess California would be the place to go! 5.2 What kind of beer styles are most popular across the US? Now that we know which states are making more beers than other, let’s find out what beer styles are popular in each state. For this we will need to look at the beer dataset, so let’s take a look at the sample of the data first. Although there are quite a few columns in the data, we will focus on state and beer style columns to answer this question. Due to a large number of beer styles in the dataset (1353 in total), we decided to only focus on the top 20 most popular beer styles across the country to avoid overplotting. Another reason is that a lot of values in the beer style columns are not actually beer styles, those values are either very specific type of a beer style such as Kali’s Kolsch or a beer name that is misplaced in the beer style column such as Crimes of Calculations Fermented In Tempernillo Barrels. We decided not to compare the absolute frequencies across states due to the fact that states such as California and New York have way more breweries than states like Mississippi, the fills associated with those dominate states would overshadow the other states in a heatmap. To work around this issue, we calculated the relative frequency of the beer styles for each state and used it as the fill in the heatmap. And this is a reasonable decision because we just wanted to see what types of beer are more popular in different states. The x-axis is ordered by the popularity of the beer style and y-axis is order by the number of breweries in the state. This heatmap clearly shows that IPAs are the most popular beers across the country with American IPA and New England IPA (NE IPA) and Double IPA (DIPA) leading on the popularity list. In particular, American IPA is the most dominant beer style in most of the states with a few exceptions. For example, breweries in Massachusetts and Connecticut tend to brew more New England IPAs, whereas Vermont and Rhode Island focus more on Double IPAs. In addition, it seems that states with more breweries tend to brew the popular kind of beers such as IPAs and the states with less breweries do not follow the trend and brew all kinds of styles. What stood out to us is that Fruited Sour is the most popular beer style in both North Dakota and South Dakota. What the heatmap has revealed actually corroborates with our experience, for instance, New England IPA first took off in the east coast such as in Massachusetts, in which the two of the best breweries TreeHouse and Trillium are located, it’s not too surprising for us to see NE IPA as the most dominant beer style there. 5.3 Do people rate beers/breweries differently across the US? One of the questions we have long suspected is that people have different rating behaviors across regions, and this question was actually motivated by a conversation with our beer friends in the Netherlands, where our Dutch friends criticized that Americans always give high ratings to beers whereas Dutch people are more objective when it comes to beer rating, as a consequence, American beers tend to receive high ratings than the Dutch/European beers. It was quite an accusation and at the same time an interesting hypothesis, so this idea has been stuck with us for a long time, now it’s time to put it to test! Unfortunately the data we’ve collected is only limited to the US, but the good news is that the same idea still applies to this data, therefore we decided to check whether people across different states have slightly different beer rating behaviors. So are people from certain states more generous or strict with ratings? To answer this question, we will go back to our brewery data, where it contains the rating of every brewery (calculated as the average of all beer ratings) from every state, we could easily dump all of brewery ratings in ridgeline plot by state to look at rating behaviors across the country. To avoid overplotting, we will only show the top 20 states with the most breweries in this analysis. Apparently most of the states follow a uni-modal distribution and their peaks are centered around the same rating, we don’t observe any differences in terms of rating behaviors across the states. So this observation contrasts with our Dutch friend’s hypothesis, perhaps he is wrong? After some serious pondering, we think our dear Dutch friend might be biased in their assessment, let’s try to explain the rationale here. Our Dutch beer friend is a beer connoisseur and is on a mission to drink the best beers in the world, he has had more than 8000 unique beers at the time of writing based on his Untappd profile, our theory is that the American beers he finds at the local beer stores in the Netherlands or beer ordering websites only carry the best American beers, in addition, he is most likely only looking for American beers with high ratings and blatantly ignoring those with low-ratings, as a consequence, his sample of American beers might be biased towards the high rating ones. To test this theory, we are going to look at the same data again, however, this time we will simulate our friends’ beer purchasing behavior where one would only order beers from the top 50 most highly rated breweries of each state. Now we can clearly see that there is a difference in terms of the distribution of the brewery ratings across the top 20 states. This confirmes our hypothesis about our friend’s biased assessment towards the American beers, and we don’t think there is a regional difference in terms of the beer rating behaviors. 5.4 What are the popular beer styles? 5.5 What are the highly rated beer styles and what makes a beer better rated? 5.6 Ratings for West Coast IPA and East Coast IPA "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "]]
